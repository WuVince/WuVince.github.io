<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Guide to the Most Important JVM Parameters"><meta name="keywords" content="Java 8"><meta name="author" content="Zhengyang Wu,undefined"><meta name="copyright" content="Zhengyang Wu"><meta name="google-site-verification" content="aEGGNzuWNauX_mi4vVYHmIAFDK_Afkdh4BuFWpLk5es"><title>Guide to the Most Important JVM Parameters | Vince's Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Overview"><span class="toc-number">1.</span> <span class="toc-text">1. Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Explicit-Heap-Memory"><span class="toc-number">2.</span> <span class="toc-text">2. Explicit Heap Memory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Garbage-Collection"><span class="toc-number">3.</span> <span class="toc-text">3. Garbage Collection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-GC-Logging"><span class="toc-number">4.</span> <span class="toc-text">4. GC Logging</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Handling-Out-of-Memory"><span class="toc-number">5.</span> <span class="toc-text">5. Handling Out of Memory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-32-64-bit"><span class="toc-number">6.</span> <span class="toc-text">6. 32/64 bit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-Misc"><span class="toc-number">7.</span> <span class="toc-text">7. Misc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Conclusion"><span class="toc-number">8.</span> <span class="toc-text">8. Conclusion</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Zhengyang Wu</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/WuVince">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">19</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">10</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">9</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/wallpaper.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Vince's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">Guide to the Most Important JVM Parameters</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-09-09</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">1,162</span><span class="post-meta__separator">|</span><span>Reading time: 7 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><blockquote>
<p>Reference from <a href="https://www.baeldung.com/jvm-parameters" target="_blank" rel="noopener">Guide to the Most Important JVM Parameters</a></p>
</blockquote>
<h2 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h2><p>In this quick tutorial, we’ll explore the most well-known options which can be used to configure the Java Virtual Machine.</p>
<h2 id="2-Explicit-Heap-Memory"><a href="#2-Explicit-Heap-Memory" class="headerlink" title="2. Explicit Heap Memory"></a>2. Explicit Heap Memory</h2><p>One of the most common performance-related practices is to initialize the heap memory as per the application requirements.<br>That’s why we should specify minimal and maximal heap size. Below parameters can be used for achieving it:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-Xms&lt;heap size&gt;[unit]</span><br><span class="line">-Xmx&lt;heap size&gt;[unit]</span><br></pre></td></tr></table></figure></p>
<p>Here, unit denotes the unit in which the memory (indicated by heap size) is to be initialized. Units can be marked as <strong>‘g’</strong> for <strong>GB</strong>, <strong>‘m’</strong> for <strong>MB</strong> and <strong>‘k’</strong> for <strong>KB</strong>.<br>For example, if we want to assign minimum 2 GB and maximum 5 GB to JVM, we need to write:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Xms2G -Xmx5G</span><br></pre></td></tr></table></figure></p>
<p>Starting with Java 8, the size of Metaspace is not defined. Once it reaches the global limit, JVM automatically increases it, However, to overcome any unnecessary instability, we can set Metaspace size with:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-XX:MaxMetaspaceSize=&lt;metaspace size&gt;[unit]</span><br></pre></td></tr></table></figure></p>
<p>Here, metaspace size denotes the amount of memory we want to assign to Metaspace.<br>As per Oracle guidelines, after total available memory, the second most influential factor is the proportion of the heap reserved for the Young Generation. By default, the minimum size of the YG is 1310 MB, and maximum size is unlimited.<br>We can assign them explicitly:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-XX:NewSize=&lt;young size&gt;[unit]</span><br><span class="line">-XX:MaxNewSize=&lt;young size&gt;[unit]</span><br></pre></td></tr></table></figure></p>
<h2 id="3-Garbage-Collection"><a href="#3-Garbage-Collection" class="headerlink" title="3. Garbage Collection"></a>3. Garbage Collection</h2><p>For better stability of the application, choosing of right <a href="https://www.oracle.com/webfolder/technetwork/tutorials/obe/java/gc01/index.html" target="_blank" rel="noopener">Garbage Collection</a> algorithm is critical.</p>
<p>JVM has four types of GC implementations:</p>
<ul>
<li>Serial Garbage Collector</li>
<li>Parallel Garbage Collector</li>
<li>CMS Garbage Collector</li>
<li>G1 Garbage Collector<br>These implementations can be declared with the below parameters:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-XX:+UseSerialGC</span><br><span class="line">-XX:+UseParallelGC</span><br><span class="line">-XX:+USeParNewGC</span><br><span class="line">-XX:+UseG1GC</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>More details on Garbage Collection implementations can be found <a href="https://www.baeldung.com/jvm-garbage-collectors" target="_blank" rel="noopener">here</a>.</p>
<h2 id="4-GC-Logging"><a href="#4-GC-Logging" class="headerlink" title="4. GC Logging"></a>4. GC Logging</h2><p>To strictly monitor the application health, we should always check the JVM’s Garbage Collection performance. The easiest way to do this is to log the GC activity in human readable format.<br>Using the following parameters, we can log the GC activity:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-XX:+UseGCLogFileRotation</span><br><span class="line">-XX:NumberOfGCLogFiles=&lt; number of log files &gt;</span><br><span class="line">-XX:GCLogFileSize=&lt; file size &gt;[ unit ]</span><br><span class="line">-Xloggc:/path/to/gc.log</span><br></pre></td></tr></table></figure></p>
<p><strong>UseGCLogFileRotation</strong> specifies the log file rolling policy, much like log4j, s4lj, etc. <strong>NumberOfGCLogFiles</strong> denotes the max number of log files that can be written for a single application life cycle. <strong>GCLogFileSize</strong> specifies the max size of the file. Finally, <strong>loggc</strong> denotes its location.<br>Point to note here is that, there are two more JVM parameters available (<strong>-XX:+PrintGCTimeStamps</strong> and <strong>-XX:+PrintGCDateStamps</strong>) which can be used to print date-wise timestamp in the GC log.<br>For example, if we want to assign a maximum of 100 GC log files, each having a maximum size of 50 MB and want to store them in ‘/home/user/log/’ location, we can use below syntax:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-XX:+UseGCLogFileRotation  </span><br><span class="line">-XX:NumberOfGCLogFiles=10</span><br><span class="line">-XX:GCLogFileSize=50M</span><br><span class="line">-Xloggc:/home/user/log/gc.log</span><br></pre></td></tr></table></figure></p>
<p>However, the problem is that one additional daemon thread is always used for monitoring system time in the background. This behavior may create some performance bottleneck; that’s why it’s always better not to play with this parameter in production.</p>
<h2 id="5-Handling-Out-of-Memory"><a href="#5-Handling-Out-of-Memory" class="headerlink" title="5. Handling Out of Memory"></a>5. Handling Out of Memory</h2><p>It’s very common for a large application to face out of memory error which, in turn, results in the application crash. It’s a very critical scenario and very hard to replicate to troubleshoot the issue.<br>That’s why JVM comes with some parameters which dump heap memory into a physical file which can be used later for finding out leaks:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-XX:+HeapDumpOnOutOfMemoryError</span><br><span class="line">-XX:HeapDumpPath=./java_pid&lt;pid&gt;.hprof</span><br><span class="line">-XX:OnOutOfMemoryError=&quot;&lt; cmd args &gt;;&lt; cmd args &gt;&quot;</span><br><span class="line">-XX:+UseGCOverheadLimit</span><br></pre></td></tr></table></figure></p>
<p>A couple of points to note here:</p>
<ul>
<li><strong>HeapDumpOnOutOfMemoryError</strong> instructs the JVM to dump heap into physical file in case of OutOfMemoryError</li>
<li><strong>HeapDumpPath</strong> denotes the path where the file is to be written; any filename can be given; however, if JVM finds a <pid> tag in the name, the process id of the current process causing the out of memory error will be appended to the file name with .hprof format</pid></li>
<li><p><strong>OnOutOfMemoryError</strong> is used to issue emergency commands to be executed in case of out of memory error; proper command should be used in the space of cmd args. For example, if we want to restart the server as soon as out of memory occur, we can set the parameter:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-XX:OnOutOfMemoryError=&quot;shutdown -r&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>UseGCOverheadLimit</strong> is a policy that limits the proportion of the VM’s time that is spent in GC before an OutOfMemory error is thrown</p>
</li>
</ul>
<h2 id="6-32-64-bit"><a href="#6-32-64-bit" class="headerlink" title="6. 32/64 bit"></a>6. 32/64 bit</h2><p>In the OS environment where both 32 and 64-bit packages are installed, the JVM automatically chooses 32-bit environmental packages.<br>If we want to set the environment to 64 bit manually, we can do so using below parameter:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-d&lt;OS bit&gt;</span><br></pre></td></tr></table></figure></p>
<p>OS bit can be either 32 or 64. More information about this can be found <a href="https://www.oracle.com/technetwork/java/hotspotfaq-138619.html#64bit_layering" target="_blank" rel="noopener">here</a>.</p>
<h2 id="7-Misc"><a href="#7-Misc" class="headerlink" title="7. Misc"></a>7. Misc</h2><ul>
<li>-server: enables “Server Hotspot VM”; this parameter is used by default in 64 bit JVM</li>
<li>-XX:+UseStringDeduplication: Java 8u20 has introduced this JVM parameter for reducing the unnecessary use of memory by creating too many instances of the same String; this optimizes the heap memory by reducing duplicate String values to a single global char[] array</li>
<li>-XX:+UseLWPSynchronization: sets LWP (Light Weight Process) – based synchronization policy instead of thread-based synchronization</li>
<li>-XX:LargePageSizeInBytes: sets the large page size used for the Java heap; it takes the argument in GB/MB/KB; with larger page sizes we can make better use of virtual memory hardware resources; however, this may cause larger space sizes for the PermGen, which in turn can force to reduce the size of Java heap space</li>
<li>-XX:MaxHeapFreeRatio: sets the maximum percentage of heap free after GC to avoid shrinking.</li>
<li>-XX:MinHeapFreeRatio: sets the minimum percentage of heap free after GC to avoid expansion; to monitor the heap usage you can use VisualVM shipped with JDK.</li>
<li>-XX:SurvivorRatio: Ratio of eden/survivor space size – for example, -XX:SurvivorRatio=6 sets the ratio between each survivor space and eden space to be 1:6,</li>
<li>-XX:+UseLargePages: use large page memory if it is supported by the system; please note that OpenJDK 7 tends to crash if using this JVM parameter</li>
<li>-XX:+UseStringCache: enables caching of commonly allocated strings available in the String pool</li>
<li>-XX:+UseCompressedStrings: use a byte[] type for String objects which can be represented in pure ASCII format</li>
<li>-XX:+OptimizeStringConcat: it optimizes String concatenation operations where possible</li>
</ul>
<h2 id="8-Conclusion"><a href="#8-Conclusion" class="headerlink" title="8. Conclusion"></a>8. Conclusion</h2><p>In this quick article, we learned about some important JVM parameters – which can be used to tune and improve general application performance.<br>Some of these can also be used for debugging purposes.<br>If you want to explore the reference parameters in more detail, you can get started <a href="http://www.oracle.com/technetwork/articles/java/vmoptions-jsp-140102.html" target="_blank" rel="noopener">here</a>.</p>
</div></article><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java-8/">Java 8</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/09/09/Java/How-to-install-Java-8-with-homebrew/"><i class="fa fa-chevron-left">  </i><span>How to install Java 8 with Home Brew</span></a></div><div class="next-post pull-right"><a href="/2018/08/23/Angular/Angular-4-Edit-Application/"><span>Edit Application</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2015 - 2020 By Zhengyang Wu</div><div class="footer_custom_text">Try not. Do, or do not. There is no try.</div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script><script src="/js/search/local-search.js"></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>