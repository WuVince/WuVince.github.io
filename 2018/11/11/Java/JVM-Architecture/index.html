<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="JVM Architecture"><meta name="keywords" content="Java 8"><meta name="author" content="Zhengyang Wu,undefined"><meta name="copyright" content="Zhengyang Wu"><meta name="google-site-verification" content="aEGGNzuWNauX_mi4vVYHmIAFDK_Afkdh4BuFWpLk5es"><title>JVM Architecture | Vince's Blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.5.6"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.6"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Overview"><span class="toc-number">1.</span> <span class="toc-text">Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-a-JVM-in-Java"><span class="toc-number">2.</span> <span class="toc-text">What is a JVM in Java ?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-JVM-works-in-Java"><span class="toc-number">3.</span> <span class="toc-text">How JVM works in Java ?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Class-Loader-Subsystem"><span class="toc-number">3.1.</span> <span class="toc-text">1. Class Loader Subsystem</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-Loading"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.1 Loading</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-Linking"><span class="toc-number">3.1.2.</span> <span class="toc-text">1.2 Linking</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-Initialization"><span class="toc-number">3.1.3.</span> <span class="toc-text">1.3 Initialization</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Runtime-Data-Area"><span class="toc-number">3.2.</span> <span class="toc-text">2. Runtime Data Area</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Execution-Engine"><span class="toc-number">3.3.</span> <span class="toc-text">3. Execution Engine</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Zhengyang Wu</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/WuVince">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">19</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">10</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">9</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/wallpaper.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Vince's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">JVM Architecture</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-11</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">1,002</span><span class="post-meta__separator">|</span><span>Reading time: 6 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><blockquote>
<p>Reference from <a href="https://www.javainterviewpoint.com/java-virtual-machine-architecture-in-java/" target="_blank" rel="noopener">JVM Architecture – Understanding JVM Internals</a></p>
</blockquote>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Every Java developer knows that bytecode will be executed by <strong>JRE</strong> (Java Runtime Environment). But many doesn’t know the fact that Interpreter is the implementation of <strong>Java Virtual Machine</strong> (JVM), which analyzes the bytecode, interprets the code and executes it. It is very important as a developer we should know the Architecture of JVM, this enables us to write code more efficiently. In this JVM architecture in Java with diagram article, we will learn more deeply about <strong>JVM architecture</strong> in Java and <strong>different components</strong> of a JVM.</p>
<h2 id="What-is-a-JVM-in-Java"><a href="#What-is-a-JVM-in-Java" class="headerlink" title="What is a JVM in Java ?"></a>What is a JVM in Java ?</h2><p>A <strong>Virtual Machine</strong> is a Software implementation of a Physical Machine, Java was developed with the concept of <strong>WORA</strong> <strong>( Write Once Run Anywhere )</strong> which runs on a VM. The compiler will be compiling the java file into a java .class file.  The .class file is input to JVM which Loads and executes the class file. Below goes the Architecture of JVM.<br><img src="https://javainterviewpoint-7ac9.kxcdn.com/wp-content/uploads/2016/01/JVM-Architecture.png" alt="JVM Architecture Diagram"></p>
<h2 id="How-JVM-works-in-Java"><a href="#How-JVM-works-in-Java" class="headerlink" title="How JVM works in Java ?"></a>How JVM works in Java ?</h2><p>As shown in the above architecture diagram JVM is divided into three main subsystems</p>
<ol>
<li><strong>Class Loader Subsystem</strong></li>
<li><strong>Runtime Data Area</strong></li>
<li><strong>Execution Engine</strong></li>
</ol>
<h3 id="1-Class-Loader-Subsystem"><a href="#1-Class-Loader-Subsystem" class="headerlink" title="1. Class Loader Subsystem"></a>1. Class Loader Subsystem</h3><p>Java’s dynamic class loading functionality is handled by the class loader subsystem. It loads, links and initializes the class when it refers to a class for the first time at <strong>runtime</strong>, not at <strong>compile-time</strong>. It performs three major functionality such as Loading, Linking, and Initialization.</p>
<h4 id="1-1-Loading"><a href="#1-1-Loading" class="headerlink" title="1.1 Loading"></a>1.1 Loading</h4><p>Classes will be loaded by this component. BootStrap ClassLoader, Extension ClassLoader, Application ClassLoader are the three class loader which will help in achieving it.</p>
<ol>
<li><strong>BootStrap ClassLoader</strong> – Responsible for loading classes from the bootstrap classpath, nothing but <strong>rt.jar</strong>. Highest priority will be given to this loader.</li>
<li><strong>Extension ClassLoader</strong> – Responsible for loading classes which are inside <strong>ext</strong> folder <strong>(jre\lib)</strong></li>
<li><strong>Application ClassLoader</strong> –Responsible for loading <strong>Application Level Classpath</strong>, path mentioned Environment Variable etc.</li>
</ol>
<p>The above <strong>Class Loaders</strong> will follow <strong>Delegation Hierarchy Algorithm</strong> while loading the class files.</p>
<h4 id="1-2-Linking"><a href="#1-2-Linking" class="headerlink" title="1.2 Linking"></a>1.2 Linking</h4><ol>
<li>Verify – Bytecode verifier will verify whether the generated bytecode is proper or not if verification fails we will get verification error</li>
<li>Prepare – For all static variables memory will be allocated and assigned with default values.</li>
<li>Resolve – All symbolic memory references are replaced with the original references from Method Area.</li>
</ol>
<h4 id="1-3-Initialization"><a href="#1-3-Initialization" class="headerlink" title="1.3 Initialization"></a>1.3 Initialization</h4><p>This is the final phase of Class Loading, here all static variable will be assigned with the original values and static block will be executed.</p>
<h3 id="2-Runtime-Data-Area"><a href="#2-Runtime-Data-Area" class="headerlink" title="2. Runtime Data Area"></a>2. Runtime Data Area</h3><p>Runtime Data Area is divided into 5 major components</p>
<ol>
<li><strong>Method Area</strong> – All the <strong>Class level data</strong> will be stored here including <strong>static variables</strong>. <strong>Method Area</strong> is <strong>one per JVM</strong> and it is a shared resource.</li>
<li><strong>Heap Area</strong> – All the <strong>Objects</strong> and its corresponding <strong>instance variables</strong> and <strong>arrays</strong> will be stored here. <strong>Heap Area</strong> is also <strong>one per JVM</strong> since <strong>Method area</strong> and <strong>Heap area</strong> shares memory for multiple threads the data stored is <strong>not thread safe.</strong></li>
<li><strong>Stack Area</strong> – For every thread, a separate <strong>runtime stack</strong> will be created. For every <strong>method call</strong>, one entry will be made in the stack memory which is called as <strong>Stack Frame</strong>. All <strong>local variables</strong> will be created in the stack memory. Stack area is thread safe since it is not a shared resource. Stack Frame is divided into three sub-entities such as<ol>
<li><strong>Local Variable Array</strong> – Related to the method how many <strong>local variables</strong> are involved and the corresponding values will be stored here.</li>
<li><strong>Operand stack</strong> – If any intermediate operation is required to perform, <strong>operand stack</strong> act as runtime workspace to perform the operation.</li>
<li><strong>Frame data</strong> – All symbols corresponding to the method is stored here. In the case of any <strong>exception</strong>, the catch block information will be maintained in the frame data.</li>
</ol>
</li>
<li><strong>PC Registers</strong> – Each thread will have separate PC Registers, to hold address of current executing instruction once the instruction is executed the <strong>PC register</strong> will be updated with the next instruction</li>
<li><strong>Native Method stacks</strong> – Native Method Stack holds native method information. For every thread, separate native method stack will be created.</li>
</ol>
<h3 id="3-Execution-Engine"><a href="#3-Execution-Engine" class="headerlink" title="3. Execution Engine"></a>3. Execution Engine</h3><p>The bytecode which is assigned to the Runtime Data Area will be executed by the Execution Engine. The Execution Engine reads the byte code and executes one by one.</p>
<ol>
<li><strong>Interpreter</strong> – Reads the bytecode, interprets it and executes it one by one. The interpreter interprets the bytecode faster but executes slowly. The disadvantage of the interpreter is that when one method called multiple times, every time interpretation is required.</li>
<li><strong>JIT Compiler</strong> – JIT Compiler neutralizes the disadvantage of the Interpreter ( a single method called multiple times, each time interpretation is required ), The Execution Engine will be using the help of Interpreter in converting but when it found repeated code it uses JIT compiler which compiles the entire bytecode and changes it to native code.  This native code will be used directly for repeated method calls which improve the performance of the system.<ol>
<li><strong>Intermediate Code generator</strong> – produces intermediate code</li>
<li><strong>Code Optimizer</strong> – Code Optimizer is responsible for optimizing the intermediate code generated above</li>
<li><strong>Target Code Generator</strong> – Target Code Generator is responsible for Generating Machine Code/ Native Code</li>
<li><strong>Profiler</strong> – <strong>Profiler</strong> is a special component, it is responsible for finding the hotspots (i.e) Used to identify whether the method is called multiple time or not.<br><strong>Garbage Collector</strong> : Garbage Collector is a part of Execution Engine, it collects/removes the unreferenced objects. Garbage Collection can be triggered by calling “System.gc()”, but the execution is not guaranteed. Garbage collector of JVM collects only those objects that are created by new keyword. So if you have created any object without new, you can use finalize method to perform cleanup.</li>
</ol>
</li>
</ol>
<p><strong>Java Native Interface</strong> (JNI):  JNI will be interacting with the Native Method Libraries and provides the Native Libraries required for the Execution Engine.</p>
<p><strong>Native Method Libraries</strong> : It is a Collection of the Native Libraries which is required for the Execution Engine.</p>
</div></article><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java-8/">Java 8</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/12/15/OOD/Google/Scheduling-Job-Involving-RAM-and-CPU/"><i class="fa fa-chevron-left">  </i><span>Scheduling Job Involving both RAM and CPU</span></a></div><div class="next-post pull-right"><a href="/2018/09/25/OOD/design-twitter/"><span>Twitter Design</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2015 - 2020 By Zhengyang Wu</div><div class="footer_custom_text">Try not. Do, or do not. There is no try.</div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.6"></script><script src="/js/fancybox.js?version=1.5.6"></script><script src="/js/sidebar.js?version=1.5.6"></script><script src="/js/copy.js?version=1.5.6"></script><script src="/js/fireworks.js?version=1.5.6"></script><script src="/js/transition.js?version=1.5.6"></script><script src="/js/scroll.js?version=1.5.6"></script><script src="/js/head.js?version=1.5.6"></script><script src="/js/search/local-search.js"></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>